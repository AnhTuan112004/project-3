<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>Trang chủ | NAT Studio</title>
    <style>
        /* Hiệu ứng Hero Section */
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.6)), url('https://images.unsplash.com/photo-1598488035139-bdbb2231ce04?auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            padding: 100px 0; /* Tăng padding để hero cao hơn */
            border-radius: 15px;
        }

        /* Hiệu ứng Card */
        .studio-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 12px;
            overflow: hidden; /* Bo tròn cả ảnh */
        }
        .studio-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15) !important;
        }
        .studio-card:hover .card-img-top {
            transform: scale(1.08); /* Zoom nhẹ ảnh */
        }
        .card-img-wrapper {
            overflow: hidden;
            position: relative;
        }
        .card-img-top {
            transition: transform 0.5s ease;
            width: 100%;
        }

        /* Chỉnh lại Pagination màu xanh */
        .page-link { color: #0d6efd; }
        .page-item.active .page-link {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }
    </style>
</head>
<body>
<div layout:fragment="content">

    <div class="container mt-4">
        <div class="hero-section text-white text-center shadow-lg mb-5 animate__animated animate__fadeIn">
            <h1 class="display-3 fw-bold mb-3 animate__animated animate__fadeInDown">NAT STUDIO</h1>
            <p class="lead mb-4 fs-4 animate__animated animate__fadeInUp">Không gian sáng tạo đỉnh cao - Âm thanh chuẩn quốc tế</p>

            <form th:action="@{/home}" method="get" class="d-flex justify-content-center mt-4 px-3">
                <div class="input-group w-100 w-md-75 shadow-lg rounded-pill overflow-hidden animate__animated animate__fadeInUp" style="animation-delay: 0.2s; max-width: 700px;">
                    <input type="text" name="keyword" class="form-control form-control-lg border-0 ps-4 py-3"
                           th:value="${keyword}"
                           placeholder="Bạn muốn tìm phòng thu nào? (Vocal, Band...)">
                    <button class="btn btn-primary btn-lg px-4 fw-bold" type="submit">
                        <i class="fas fa-search me-2"></i>Tìm kiếm
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="container mb-5">
        <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
            <h3 class="border-start border-5 border-primary ps-3 mb-0 fw-bold text-uppercase">
                <i class="fas fa-microphone-lines text-primary me-2"></i>Phòng thu nổi bật
            </h3>

            <div th:if="${studioPage != null}">
                <span class="badge bg-light text-dark border rounded-pill px-3 py-2">
                    Tổng: <strong class="text-primary" th:text="${studioPage.totalElements}">0</strong> phòng
                </span>
            </div>
        </div>

        <div th:if="${studios == null || studios.empty}" class="text-center py-5 bg-light rounded-4 border border-dashed">
            <div class="opacity-50 mb-3"><i class="fas fa-search fa-3x text-muted"></i></div>
            <h5 class="text-secondary fw-bold">Không tìm thấy phòng thu phù hợp!</h5>
            <p class="text-muted">Hãy thử từ khóa khác hoặc xóa bộ lọc để xem tất cả.</p>
            <a th:href="@{/home}" class="btn btn-outline-primary rounded-pill px-4 hover-shadow">
                <i class="fas fa-sync-alt me-1"></i> Xóa bộ lọc
            </a>
        </div>

        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            <div class="col" th:each="studio : ${studios}">
                <div class="card h-100 shadow-sm studio-card border-0">
                    <div class="card-img-wrapper position-relative">
                        <span class="position-absolute top-0 end-0 m-3 badge bg-primary bg-gradient shadow-sm z-index-1"
                              th:text="${studio.studioType}">TYPE</span>

                        <img th:src="${studio.imageUrl != null && studio.imageUrl != '' ? studio.imageUrl : 'https://placehold.co/600x400?text=NAT+Studio'}"
                             class="card-img-top"
                             th:alt="${studio.name}"
                             style="height: 220px; object-fit: cover;"
                             onerror="this.src='https://placehold.co/600x400?text=Image+Error'">
                    </div>

                    <div class="card-body">
                        <h5 class="card-title fw-bold text-dark text-truncate" th:text="${studio.name}">Tên phòng</h5>

                        <p class="card-text text-muted small mb-3"
                           style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; height: 38px;"
                           th:text="${studio.description}"></p>

                        <div class="d-flex justify-content-between align-items-center mt-3 pt-3 border-top">
                            <div class="small text-warning">
                                <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                                <span class="text-muted ms-1 text-xs">(4.8)</span>
                            </div>
                            <h5 class="text-success fw-bold mb-0">
                                <span th:text="${#numbers.formatDecimal(studio.pricePerHour, 0, 'POINT', 0, 'COMMA')}"></span>
                                <small class="fs-6 text-muted">₫/h</small>
                            </h5>
                        </div>
                    </div>

                    <div class="card-footer bg-white border-top-0 pb-4 pt-0 px-4">
                        <a th:href="@{/studio/{id}(id=${studio.id})}" class="btn btn-dark w-100 fw-bold rounded-pill shadow-sm py-2">
                            Xem chi tiết & Đặt <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="d-flex justify-content-center mt-5" th:if="${totalPages > 1}">
            <nav aria-label="Page navigation">
                <ul class="pagination shadow-sm">
                    <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                        <a class="page-link rounded-start-pill border-0"
                           th:href="@{/home(page=${currentPage - 1}, keyword=${keyword})}" aria-label="Previous">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    </li>

                    <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
                        th:classappend="${i == currentPage} ? 'active'">
                        <a class="page-link border-0 mx-1 rounded"
                           th:href="@{/home(page=${i}, keyword=${keyword})}"
                           th:text="${i + 1}">1</a>
                    </li>

                    <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                        <a class="page-link rounded-end-pill border-0"
                           th:href="@{/home(page=${currentPage + 1}, keyword=${keyword})}" aria-label="Next">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="bg-light py-5 mb-5 border-top border-bottom">
        <div class="container">
            <div class="row text-center g-4">
                <div class="col-md-4">
                    <div class="p-4 bg-white rounded-4 shadow-sm h-100">
                        <div class="mb-3 text-primary"><i class="fas fa-sliders-h fa-3x"></i></div>
                        <h5 class="fw-bold">Thiết bị hiện đại</h5>
                        <p class="text-muted small mb-0">Micro Neumann, Preamp Avalon và hệ thống cách âm tiêu chuẩn quốc tế.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="p-4 bg-white rounded-4 shadow-sm h-100">
                        <div class="mb-3 text-primary"><i class="fas fa-clock fa-3x"></i></div>
                        <h5 class="fw-bold">Đặt lịch 24/7</h5>
                        <p class="text-muted small mb-0">Hệ thống đặt phòng trực tuyến tiện lợi, xác nhận lịch ngay tức thì.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="p-4 bg-white rounded-4 shadow-sm h-100">
                        <div class="mb-3 text-primary"><i class="fas fa-music fa-3x"></i></div>
                        <h5 class="fw-bold">Kỹ thuật viên Pro</h5>
                        <p class="text-muted small mb-0">Đội ngũ kỹ thuật viên giàu kinh nghiệm hỗ trợ Mix & Master.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mb-5" th:if="${posts != null && !posts.empty}">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="border-start border-5 border-danger ps-3 mb-0 fw-bold text-uppercase">
                <i class="fas fa-newspaper text-danger me-2"></i>Tin tức âm nhạc
            </h3>
            <a th:href="@{/posts}" class="btn btn-sm btn-outline-danger rounded-pill px-3 fw-bold">
                Xem tất cả <i class="fas fa-arrow-right ms-1"></i>
            </a>
        </div>

        <div class="row g-4">
            <div class="col-md-4" th:each="post, iterStat : ${posts}" th:if="${iterStat.index < 3}">
                <a th:href="@{/post/{id}(id=${post.id})}" class="text-decoration-none text-dark">
                    <div class="card border-0 shadow-sm h-100 studio-card">
                        <div class="overflow-hidden rounded-top position-relative">
                            <img th:src="${post.imageUrl != null ? post.imageUrl : 'https://placehold.co/600x400?text=News'}"
                                 class="card-img-top" style="height: 200px; object-fit: cover;"
                                 onerror="this.src='https://placehold.co/600x400?text=Error'">
                            <span class="badge bg-danger position-absolute top-0 start-0 m-3">New</span>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between mb-2 small text-muted">
                                <span><i class="far fa-user me-1"></i>Admin</span>
                                <span><i class="far fa-calendar-alt me-1"></i>[[${#temporals.format(post.createdAt, 'dd/MM/yyyy')}]]</span>
                            </div>
                            <h6 class="card-title fw-bold text-truncate-2-lines mb-2" th:text="${post.title}" style="min-height: 40px;">Tiêu đề bài viết</h6>

                            <p class="card-text text-muted small text-truncate" th:text="${post.title}"></p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>

</div>
</body>
</html>